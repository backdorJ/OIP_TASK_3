# Задание 3 — Инвертированный индекс и булев поиск
# Набиуллин Дамир Рафаэлевич 11-208

## Цель

1. Построить **инвертированный индекс** (список терминов с номерами документов).
2. Реализовать **булев поиск** по этому индексу с операторами AND, OR, NOT и возможностью вводить сложные запросы со скобками.

---

## Что реализовано

- **Инвертированный индекс** — скрипт `build_inverted_index.py` строит по токенизированным страницам файл `inverted_index.txt`.
- **Булев поиск** — скрипт `boolean_search.py`:
  - операторы **AND**, **OR**, **NOT**;
  - сложные запросы со скобками, например:  
    `(Клеопатра AND Цезарь) OR (Антоний AND Цицерон) OR Помпей`;
  - запрос задаётся **строкой** (с клавиатуры или аргументом командной строки), а не захардкожен в коде.

---

## Требования

- Python 3.9+
- Для построения индекса нужна уже готовая папка **tokenized_pages/** (результат работы `lemma_token_builder.py` из предыдущих шагов проекта).

---

## Шаг 1. Построить инвертированный индекс

```bash
python build_inverted_index.py
```

- Читает все файлы **tokenized_pages/pageN/lemmas.txt**.
- Для каждой леммы собирает множество номеров документов (doc_id), в которых она встречается.
- Записывает результат в **inverted_index.txt**.

**Формат inverted_index.txt:**  
Одна строка на терм (лемму): сначала лемма, затем через пробел — отсортированный список номеров документов.

```
москва 1 2 3 4 5 6 7 8 10 11 ...
цезарь 25 26 40 47 87
помпей 32 38
```

---

## Шаг 2. Булев поиск

```bash
python boolean_search.py
```

После запуска программа предлагает ввести запрос с клавиатуры.

**Либо** передать запрос аргументом:

```bash
python boolean_search.py "москва AND россия"
python boolean_search.py "(математика AND физика) OR химия"
python boolean_search.py "NOT философия"
```

### Операторы

| Оператор | Значение | Пример |
|----------|----------|--------|
| **AND**  | Оба слова в документе (пересечение множеств) | `москва AND россия` |
| **OR**   | Хотя бы одно слово (объединение множеств)    | `цезарь OR помпей`  |
| **NOT**  | Документы без данного слова (дополнение)      | `NOT философия`     |

Скобки задают порядок вычисления:  
`(Клеопатра AND Цезарь) OR (Антоний AND Цицерон) OR Помпей`

### Результат

Программа выводит количество найденных документов и для каждого — **doc_id** и **URL** (из `index.txt`).

---

## Файлы задания 3

| Файл | Назначение |
|------|------------|
| **build_inverted_index.py** | Строит инвертированный индекс по `tokenized_pages/` |
| **boolean_search.py**       | Булев поиск по индексу (AND, OR, NOT, скобки)      |
| **inverted_index.txt**     | Файл инвертированного индекса (результат шага 1)  |

Для работы булева поиска также используется **index.txt** (соответствие doc_id ↔ URL), создаваемый краулером на предыдущих этапах проекта.

---

## Примеры запросов

```
москва
москва AND россия
цезарь OR помпей
(антоний AND цицерон) OR помпей
NOT философия
(математика AND физика) OR химия OR биология
```

Регистр операторов и слов не важен; термы при поиске приводятся к нижнему регистру (по леммам в индексе).
